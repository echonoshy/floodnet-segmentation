
# FloodNet 数据集图像语义分割技术报告

## 简介

本套代码及相关内容是在FloodNet有监督数据集上实现图像语义分割任务，旨在设计一套通过快速构造不同模型，对数据集进行训练、预测和可视化的简易框架。

### 数据集描述
FloodNet使用无人机拍摄的灾害过后被洪水淹没的航拍影像数据集

Features: 
	1. Dataset is distributed same as FloodNet challenge.
	2. Masks are same size as original images.
	3. Total class: 10 ('Background':0, 'Building-flooded':1, 'Building-non-flooded':2, 'Road-flooded':3, 'Road-non-flooded':4, 'Water':5, 'Tree':6, 'Vehicle':7, 'Pool':8, 'Grass':9).
	4. Total image: 2343 (Train: 1445, Val: 450, Test: 448)


### 实验环境
- MacOS 14.4

- Linux (GPU)
    - PyTorch:  2.1.0
    - Python:  3.10(ubuntu22.04)
    - Cuda:  12.1
    - GPU: RTX 4090(24GB) * 1
    - CPU: 12 vCPU Intel(R) Xeon(R) Platinum 8352V CPU @ 2.10GHz


### 主要文件结构及作用
- config/: 配置文件，模型相关的配置参数和指定当前需要训练的模型
- core/ : 模型训练相关主要代码
- exp/ 模型训练数据生成文件
- logs/ 模型训练日志
- models: 自定义模型结构
- utils: 辅助工具，如数据集验证工具，与主程序无关
- train.py 训练脚本入口
- test.py 模型效果验证
- visualize.py 模型效果可视化


### 快速上手
1. 修改config中数据集路径，batch size等配置， 设置activate_model
2. python train.py 
3. python test.py
4. python visualize.py




## 实验思路

### 使用的模型
- **U-Net**：一种专门为生物医学图像分割设计的卷积神经网络，也适用于通用的图像分割任务。
- **PSPNet**：金字塔场景解析网络，通过金字塔池化捕获全局上下文信息。
- **DeepLab**：一个先进的网络，利用空洞卷积和空间金字塔池化来获取多尺度上下文。

### 预处理和训练
- **图像调整**：所有图像和标签都调整为 512x512 像素，以匹配模型的输入尺寸。
- **归一化**：使用数据集特定的均值和标准差对图像进行归一化，以保持与训练数据分布的一致性。

### 评估
- **指标**：
  - **mIoU**：平均交并比（Mean Intersection over Union）用于衡量预测和真实标签的重叠程度。
  - **Dice 系数**：评估预测与真实标签之间的相似度。

- **可视化**：为了进行定性比较，将模型的预测结果与输入图像和真实标签并排显示。

### 实验过程
1. **训练**：
   - 为每个模型使用一致的训练流程，在固定的训练轮次内训练。
   - 仔细选择优化器和学习率，确保公平比较。

2. **测试**：
   - 加载每个预训练模型，并使用它来预测测试集的分割结果。
   - 为每个模型计算 mIoU 和 Dice 系数。
   - 对测试图像的一个子集进行预测结果可视化。

### 实验中遇到的问题
- **数据不平衡**：某些类别在样本数量上存在明显的不平衡，尤其是小目标或较少出现的类别，这对模型的分割准确度产生影响。
- **预处理兼容性**：不同的归一化值和转换要求需要仔细调整，以符合模型的训练期望。
- **硬件限制**：由于图像分辨率较高，在使用较复杂的网络（如 DeepLab）时，容易出现内存问题。

## 实验结果与分析

- **定量结果**：
  - U-Net、PSPNet 和 DeepLab 在不同类别上的表现各有不同，其中 DeepLab 在识别复杂类别如淹没建筑方面表现更好。

- **定性分析**：
  - 并排对比每个模型的预测结果，有助于清晰比较它们的分割质量。
  - 一些类别如“水”和“道路”容易区分，但“草地”和“树木”相对较难。

### 对未来工作的建议

- **数据增强**：应用更多的数据增强技术，有助于提高对样本较少类别的预测鲁棒性。
- **模型集成**：结合多个模型的预测结果，利用各自的优势可以生成更准确的结果。
- **超参数优化**：进一步优化模型超参数，如学习率调整策略和损失函数，以提高准确性。

### 结论

通过本实验，我们探索了不同语义分割模型在 FloodNet 数据集上的表现。尽管它们在不同类别的表现各有不同，每个模型都展现出了独特的优势。通过可视化和定量分析，为我们理解模型的行为和洪水场景中的挑战提供了宝贵的见解。未来的工作应侧重于改进预处理技术，并探索模型集成方法以提高分割准确性。